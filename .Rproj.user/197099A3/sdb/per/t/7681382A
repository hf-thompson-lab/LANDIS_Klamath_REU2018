{
    "collab_server" : "",
    "contents" : "library(ggpubr)\nlibrary(ggplot2)\nlibrary(reshape2)\nlibrary(raster)\nlibrary(scales)\n\n#set up ----\nscenarioPath <-\"C:/Users/hfintern/Desktop/sa3_10YTS\"## \"C:/Users/hfintern/Desktop/sa3_Scenarios\"\n\nsims <- list.dirs(scenarioPath, recursive = F, full.names = F)\nsims<- sims[!grepl(\"Graphs\",sims)]\n\nsimus.selection <- sims \ngeneral.root.path <- scenarioPath\ncommon.names <- c(\"A2 Climate\",\"A2 Climate & LU\",\"Recent Trends\",\"Recent Trends & LU\")#the order has to match the order of the simus.selection\n\ntimesteps <- 1:9 * 10 \ntimesteps\n\n## making and plot mean fire return intervals ---- \nmask.active.cells <- raster('C:/Users/hfintern/Desktop/masksa3.img')\n\nrasters <- lapply (simus.selection, function (sim){\n  \n  setwd(general.root.path)\n  setwd(sim)\n  \n  if (length(list.files(path = './fire')) ==0) { return(NULL) }\n  ras.list <- paste0('fire/severity-',timesteps,'.img') \n  rastack  <- stack (ras.list)\n  \n  rastack <- reclassify(rastack,rcl = matrix (ncol = 3,byrow=T,data =c(-1,2.5,0,2.6,20,1)))\n  \n  try1 <- calc (rastack, fun= function (a){\n    m <- rle(a)\n    o <- mean(m$lengths [which (m$values==0)],na.rm=T)\n    if (is.nan(o)){o<-NA}\n    return(o)\n  })\n  extent(try1) <- extent (mask.active.cells)\n  mfri <- try1 * mask.active.cells\n  #plot(mfri, add=T, title=sim)\n  #writeRaster(mfri,paste0('fire/MeanFireInterval.img'),overwrite=T,format=\"HFA\", datatype=\"INT2S\", NAvalue=0 )\n  return(mfri)\n})\n\ns1 <- stack(rasters)\nsp1<- as(s1, 'SpatialGridDataFrame')\nnotseededplots<- spplot(sp1,names.attr= common.names, main = list(\"Mean Fire Return Interval (Years)\", cex=2),\n                        colorkey=list(height =.75, at=seq(10, 100, 10) ), labels=seq(10, 100, 10) ,  col.regions = colorRampPalette(c(\"red\", \"yellow\",\"grey\",\"white\") ) )\nplot(notseededplots)\n\n\n\n# ploting AGB for each simulation ---- \n\nconstrainPlot <- function(plot, xlim= c(0,max(timesteps)), ylim){\n  cp <- plot  + scale_y_continuous(limits= ylim)\n  return(cp)\n}\n\ngraphs <- list()\ngraphs <- lapply (simus.selection, function (sim){\n  \n  setwd(general.root.path)\n  setwd(sim)\n  \n  agbPath<- \"output/agbiomass/AGBiomass_.txt\"\n  agb<- read.table(agbPath, header=T)\n  \n  colnames(agb)[colnames(agb)==\"ABGRCg.m2\"] <- \"Grand fir\"\n  colnames(agb)[colnames(agb)==\"ACMA3g.m2\"] <- \"Bigleaf maple\"\n  colnames(agb)[colnames(agb)==\"ALRU2g.m2\"] <- \"Red alder\"\n  colnames(agb)[colnames(agb)==\"PIMO3g.m2\"] <- \"Western white pine\"\n  colnames(agb)[colnames(agb)==\"PSMEg.m2\"]  <- \"Douglas fir\"\n  print(colnames(agb))\n  \n  meltagb <- melt(agb, id = \"Time\") \n  \n  p1<- ggplot(meltagb , aes(x= Time, y= value, color=variable)) +geom_smooth() + labs(subtitle= common.names[which(simus.selection == sim)], y=\"\", x=\"\", color=\"Species\") + theme_bw(base_size = 20)\n  p1 <- constrainPlot(p1, ylim = c(0,10500)) + scale_x_continuous(labels= 2010+c(0,timesteps), breaks = c(0,timesteps), limits = c(0,max(timesteps))) + guides(color=guide_legend(override.aes=list(fill=NA)))#+\n  # scale_color_manual(labels = c(\"1\", \"2\",\"3\", \"4\", \"5\"), values=  hue_pal()(5))\n  return(p1)\n})\n\nagbFig<- ggarrange(graphs[[1]],graphs[[2]],graphs[[3]],graphs[[4]], ncol=2, nrow=2, common.legend = TRUE, legend=\"top\") \nannotate_figure(agbFig,  top = text_grob(paste(\"Change in Aboveground Biomass\"), color = \"Black\", face = \"bold\", size = 25),\n                bottom = text_grob(\"Year\", color = \"Black\", size = 25),\n                left = text_grob(expression(paste(\n                  \"Aboveground Biomass (\",\n                  g, \"/\", m^2,\n                  \")\", sep=\"\")), color = \"Black\", rot = 90,size = 25))\n\n\n\n\n# graphing fire stats ---- \ndataFrames <- lapply (simus.selection, function (sim){\n  setwd(general.root.path)\n  setwd(sim)\n  if (length(list.files(path = './fire')) ==0) { return(NULL) }\n  fireEventPath <- \"dynamic-fire-events-log.csv\"\n  dfe <- read.csv(fireEventPath, header=T)\n  len <- length(timesteps)\n  ms <- numeric(len)\n  meds <- numeric(len)\n  mck <- numeric(len)\n  medck<- numeric(len)\n  size <- numeric(len)\n  for (i in 1:length(timesteps))\n  {\n    ms[i] <- mean(dfe[dfe$Time==timesteps[i],]$MeanSeverity)\n    meds[i] <- median(dfe[dfe$Time==timesteps[i],]$MeanSeverity)\n    mck[i] <- sum(dfe[dfe$Time==timesteps[i],]$CohortsKilled)\n    medck[i] <- sum(dfe[dfe$Time==timesteps[i],]$TotalSites)\n    size[i] <- max(dfe[dfe$Time==timesteps[i],]$SizeBin)\n    \n  }\n  \n  df <-data.frame(Time = timesteps, MeanSeverity=ms, MedianSeverity=meds,CohortsKilled=mck, TotalSites=medck, Size= size,  SIM=rep(sim, len))\n  return(df)\n})\n\ncompletedf<- do.call( rbind, dataFrames)\n\nmeltdf <- melt(completedf, id=c(\"Time\", \"MedianSeverity\", \"CohortsKilled\", \"TotalSites\", \"MeanSeverity\", \"Size\" ))\n\np4<- ggplot(meltdf, aes(x=Time, y=MeanSeverity, color= value)) + geom_smooth(level=.9) + theme_bw() +  labs(title=\"MeanSeverity\");p4\n\np5<- ggplot(meltdf, aes(x=Time, y=CohortsKilled, color= value)) + geom_smooth(level=.9) + geom_jitter() + theme_bw()+  labs(title=\"CohortsKilled\");p5\n\n\n\np6<- ggplot(meltdf, aes(x=Time, y=TotalSites, color= value))+geom_point() + geom_smooth() + theme_bw()+  labs(title=\"TotalSites\");p6\n\nmeltdf$Size[meltdf$Size==\"-Inf\"]<-0 \np7<- ggplot(meltdf, aes(x=Time, y=Size, color= value))+geom_point() + geom_smooth() + theme_bw()+  labs(title=\"Max fire Size\");p7\n\n\nhist1<- ggplot(meltdf) + geom_histogram(aes(MeanSeverity), bins=10) + facet_wrap(~value, ncol=1) + theme_bw()\nhist2<- ggplot(meltdf) + geom_histogram(aes(TotalSites*7.29), bins=10) + facet_wrap(~value, ncol=1) + theme_bw()\nhist3<- ggplot(meltdf) + geom_histogram(aes(CohortsKilled), bins=10) + facet_wrap(~value, ncol=1) + theme_bw()\nggarrange(hist1, hist2, hist3, ncol=3)\n\np = ggplot(meltdf, aes(x=Size)) + theme_bw()+\n  geom_histogram(position=\"identity\", colour=\"grey40\", alpha=0.2, bins = 6, breaks=c(0,1,2,3,4,5)) +  labs(title=\"Max recorded fire size over all years\")+\n  facet_grid(. ~ value);p\n\n\n# testing of dividing the data into early, mid, and late periods and then graphing box plots ----\n# \n# # early  1:30\n# # mid    31 :60 \n# # late   61:91 \n# \n# earlyTest <- subset(meltdf , meltdf$Time %in% 1:30)\n# t1<- ggplot(earlyTest, aes(x=value, y=MeanSeverity, color= value)) + geom_boxplot() + ylim(c(3,5)) + labs(title=\"Early\" )+ theme_bw() +theme(plot.title = element_text(margin = margin(t = 10, b = -30)))+theme(plot.title = element_text(hjust = 0.5))+ theme(axis.title.x=element_blank(), axis.text.x=element_blank(),axis.ticks.x=element_blank())\n# \n# midTest <- subset(meltdf, meltdf$Time %in% 31:60)\n# t2<- ggplot(midTest, aes(x=value, y=MeanSeverity, color= value)) + geom_boxplot()+ ylim(c(3,5))+ labs(title=\"Middle\" ) + theme_bw() +theme(plot.title = element_text(margin = margin(t = 10, b = -30)))+theme(plot.title = element_text(hjust = 0.5))+  theme(axis.title.x=element_blank(), axis.text.x=element_blank(),axis.ticks.x=element_blank())+theme(axis.title.y=element_blank(), axis.text.y=element_blank(),axis.ticks.y=element_blank(), axis.line.y = element_line(colour=\"grey40\", linetype = \"dashed\"))\n# \n# \n# lateTest <- subset(meltdf,  meltdf$Time %in% 61:91)\n# t3<- ggplot(lateTest, aes(x=value, y=MeanSeverity, color= value)) + geom_boxplot()+ ylim(c(3,5)) + labs(title=\"Late\" )+ theme_bw() +theme(plot.title = element_text(margin = margin(t = 10, b = -30))) +theme(plot.title = element_text(hjust = 0.5))+   theme(axis.title.x=element_blank(), axis.text.x=element_blank(),axis.ticks.x=element_blank())+theme(axis.title.y=element_blank(), axis.text.y=element_blank(),axis.ticks.y=element_blank(), axis.line.y = element_line(colour=\"grey40\", linetype = \"dashed\"))\n# \n# figure <- ggarrange(t1,t2,t3, common.legend=T, legend=\"bottom\", ncol=3) \n# \n# annotate_figure(figure,  top = text_grob(\"Mean Severity\", color = \"Black\", face = \"bold\", size = 14))#,bottom = text_grob(\"Data source: \\n ToothGrowth data set\", color = \"blue\", hjust = 1, x = 1, face = \"italic\", size = 10))\n# \n# \n# vars.toGraph <- c(\"MeanSeverity\", \"CohortsKilled\", \"TotalSites\", \"Size\" )\n# \n# \n# ## TOTAL AREA AFFECTED BY FIRES \n# labs <- c(\"A2 scenario\", \"A2 scenario & LU+\", \"Recent Trends\", \"Recent Trends & LU+\")\n# \n# earlyTest <- subset(meltdf,  meltdf$Time %in% 1:15)\n# midTest <- subset(meltdf, meltdf$Time %in% 16:30)\n# maxVal <- max(max(earlyTest$TotalSites*7.29), max(midTest$TotalSites*7.29))\n# \n# t1<- ggplot(earlyTest, aes(x=value, y=TotalSites*7.29, color= value)) + geom_boxplot() + labs(title=\"Early\" )+ theme_bw() +theme(plot.title = element_text(margin = margin(t = 10, b = -30)))+theme(plot.title = element_text(hjust = 0.5))+ theme(axis.title.x=element_blank(), axis.text.x=element_blank(),axis.ticks.x=element_blank() )+ theme(axis.title.y=element_blank())+\n#   scale_x_discrete(labels=labs) + theme(axis.text.x = element_text(angle = 75)) + ylim(0, maxVal) # add in limits \n# \n# \n# \n# t2<- ggplot(midTest, aes(x=value, y=TotalSites*7.29, color= value)) + geom_boxplot()+ labs(title=\"Middle\" ) + theme_bw() +theme(plot.title = element_text(margin = margin(t = 10, b = -30)))+theme(plot.title = element_text(hjust = 0.5))+ theme(axis.title.x=element_blank(), axis.text.x=element_blank(),axis.ticks.x=element_blank())+#theme(axis.title.y=element_blank(), axis.text.y=element_blank(),axis.ticks.y=element_blank(), axis.line.y = element_line(colour=\"grey40\", linetype = \"dashed\"))+\n#   scale_x_discrete(labels=labs) + theme(axis.text.x = element_text(angle = 75)) +ylim(0, maxVal)\n# \n# \n# lateTest <- subset(meltdf, grepl(3333,meltdf$value, ignore.case = T ) & meltdf$Time %in% 61:91)\n# t3<- ggplot(lateTest, aes(x=value, y=TotalSites*7.29, color= value)) + geom_boxplot() + labs(title=\"Late\" )+ theme_bw() +theme(plot.title = element_text(margin = margin(t = 10, b = -30))) +theme(plot.title = element_text(hjust = 0.5))+ theme(axis.title.x=element_blank(), axis.text.x=element_blank(),axis.ticks.x=element_blank())+theme(axis.title.y=element_blank(), axis.text.y=element_blank(),axis.ticks.y=element_blank(), axis.line.y = element_line(colour=\"grey40\", linetype = \"dashed\"))+\n#   scale_x_discrete(labels=labs) + theme(axis.text.x = element_text(angle = 75))\n# \n# figure <- ggarrange(t1,t2,t3, common.legend=T, legend=\"none\", ncol=3) \n# \n# comp <- annotate_figure(figure,  top = text_grob(paste(\"Total area affected by fires\", \"(Seed 3333)\"), color = \"Black\", face = \"bold\", size = 14),\n#                         bottom = text_grob(\"Scenarios\", color = \"Black\", face = \"bold\", size = 12),\n#                         left = text_grob(\"Area (ha)\", color = \"Black\",face = \"bold\", rot = 90,size = 12))\n# #,bottom = text_grob(\"Data source: \\n ToothGrowth data set\", color = \"blue\", hjust = 1, x = 1, face = \"italic\", size = 10))\n# comp\n# \n# \n# ## cohorts killed  \n# labs <- c(\"A2 scenario\", \"A2 scenario & LU+\", \"Recent Trends\", \"Recent Trends & LU+\")\n# \n# earlyTest <- subset(meltdf, grepl(3333,meltdf$value, ignore.case = T ) & meltdf$Time %in% 1:30)\n# t1<- ggplot(earlyTest, aes(x=value, y=CohortsKilled, color= value)) + geom_boxplot() + labs(title=\"Early\" )+ theme_bw() +theme(plot.title = element_text(margin = margin(t = 10, b = -30)))+theme(plot.title = element_text(hjust = 0.5))+ theme(axis.title.x=element_blank(), axis.text.x=element_blank(),axis.ticks.x=element_blank() )+ theme(axis.title.y=element_blank())+\n#   scale_x_discrete(labels=labs) + theme(axis.text.x = element_text(angle = 75)) +# geom_jitter(width=.3)+\n#   stat_summary(fun.y = \"mean\", geom = \"point\", shape = 8, size = 2)\n# \n# \n# midTest <- subset(meltdf, grepl(3333,meltdf$value, ignore.case = T ) & meltdf$Time %in% 31:60)\n# t2<- ggplot(midTest, aes(x=value, y=CohortsKilled, color= value)) + geom_boxplot()+ labs(title=\"Middle\" ) + theme_bw() +theme(plot.title = element_text(margin = margin(t = 10, b = -30)))+theme(plot.title = element_text(hjust = 0.5))+  theme(axis.title.x=element_blank(), axis.text.x=element_blank(),axis.ticks.x=element_blank())+theme(axis.title.y=element_blank(), axis.text.y=element_blank(),axis.ticks.y=element_blank(), axis.line.y = element_line(colour=\"grey40\", linetype = \"dashed\"))+\n#   scale_x_discrete(labels=labs) + theme(axis.text.x = element_text(angle = 75))+# geom_jitter(width=.3)+\n#   stat_summary(fun.y = \"mean\", geom = \"point\", shape = 8, size = 2)\n# \n# \n# lateTest <- subset(meltdf, grepl(3333,meltdf$value, ignore.case = T ) & meltdf$Time %in% 61:91)\n# t3<- ggplot(lateTest, aes(x=value, y=CohortsKilled, color= value)) + geom_boxplot() + labs(title=\"Late\" )+ theme_bw() +theme(plot.title = element_text(margin = margin(t = 10, b = -30))) +theme(plot.title = element_text(hjust = 0.5))+   theme(axis.title.x=element_blank(), axis.text.x=element_blank(),axis.ticks.x=element_blank())+theme(axis.title.y=element_blank(), axis.text.y=element_blank(),axis.ticks.y=element_blank(), axis.line.y = element_line(colour=\"grey40\", linetype = \"dashed\"))+\n#   scale_x_discrete(labels=labs) + theme(axis.text.x = element_text(angle = 75)) +# geom_jitter(width=.3)+\n#   stat_summary(fun.y = \"mean\", geom = \"point\", shape = 8, size = 2)\n# \n# figure <- ggarrange(t1,t2,t3, common.legend=T, legend=\"none\", ncol=3) \n# \n# comp <- annotate_figure(figure,  top = text_grob(paste(\"CohortsKilled\", \"(Seed 3333)\"), color = \"Black\", face = \"bold\", size = 14),\n#                         bottom = text_grob(\"Scenarios\", color = \"Black\", face = \"bold\", size = 12),\n#                         left = text_grob(\"Number of cohorts killed\", color = \"Black\",face = \"bold\", rot = 90,size = 12))\n# \n# comp\n# \n# ## MeanSeverity\n# labs <- c(\"A2 scenario\", \"A2 scenario & LU+\", \"Recent Trends\", \"Recent Trends & LU+\")\n# \n# earlyTest <- subset(meltdf, grepl(3333,meltdf$value, ignore.case = T ) & meltdf$Time %in% 1:30)\n# t1<- ggplot(earlyTest, aes(x=value, y=MeanSeverity, color= value)) + geom_boxplot() + labs(title=\"Early\" )+ theme_bw() +theme(plot.title = element_text(margin = margin(t = 10, b = -30)))+theme(plot.title = element_text(hjust = 0.5))+ theme(axis.title.x=element_blank(), axis.text.x=element_blank(),axis.ticks.x=element_blank() )+ theme(axis.title.y=element_blank())+\n#   scale_x_discrete(labels=labs) + theme(axis.text.x = element_text(angle = 75)) +# geom_jitter(width=.3)+\n#   stat_summary(fun.y = \"mean\", geom = \"point\", shape = 8, size = 2)+ ylim(c(3.5,4.75))\n# \n# \n# midTest <- subset(meltdf, grepl(3333,meltdf$value, ignore.case = T ) & meltdf$Time %in% 31:60)\n# t2<- ggplot(midTest, aes(x=value, y=MeanSeverity, color= value)) + geom_boxplot()+ labs(title=\"Middle\" ) + theme_bw() +theme(plot.title = element_text(margin = margin(t = 10, b = -30)))+theme(plot.title = element_text(hjust = 0.5))+  theme(axis.title.x=element_blank(), axis.text.x=element_blank(),axis.ticks.x=element_blank())+theme(axis.title.y=element_blank(), axis.text.y=element_blank(),axis.ticks.y=element_blank(), axis.line.y = element_line(colour=\"grey40\", linetype = \"dashed\"))+\n#   scale_x_discrete(labels=labs) + theme(axis.text.x = element_text(angle = 75))+# geom_jitter(width=.3)+\n#   stat_summary(fun.y = \"mean\", geom = \"point\", shape = 8, size = 2) + ylim(c(3.5,4.75))\n# \n# \n# lateTest <- subset(meltdf, grepl(3333,meltdf$value, ignore.case = T ) & meltdf$Time %in% 61:91)\n# t3<- ggplot(lateTest, aes(x=value, y=MeanSeverity, color= value)) + geom_boxplot() + labs(title=\"Late\" )+ theme_bw() +theme(plot.title = element_text(margin = margin(t = 10, b = -30))) +theme(plot.title = element_text(hjust = 0.5))+   theme(axis.title.x=element_blank(), axis.text.x=element_blank(),axis.ticks.x=element_blank())+theme(axis.title.y=element_blank(), axis.text.y=element_blank(),axis.ticks.y=element_blank(), axis.line.y = element_line(colour=\"grey40\", linetype = \"dashed\"))+\n#   scale_x_discrete(labels=labs) + theme(axis.text.x = element_text(angle = 75)) +# geom_jitter(width=.3)+\n#   stat_summary(fun.y = \"mean\", geom = \"point\", shape = 8, size = 2)+ ylim(c(3.5,4.75))\n# \n# figure <- ggarrange(t1,t2,t3, common.legend=T, legend=\"none\", ncol=3) \n# \n# comp <- annotate_figure(figure,  top = text_grob(paste(\"MeanSeverity\", \"(Seed 3333)\"), color = \"Black\", face = \"bold\", size = 14),\n#                         bottom = text_grob(\"Scenarios\", color = \"Black\", face = \"bold\", size = 12),\n#                         left = text_grob(\"Fire severity\", color = \"Black\",face = \"bold\", rot = 90,size = 12))\n# \n# comp\n\n## extracting number of highest severity cells ----\n\nrdata <- lapply (simus.selection, function (sim){\n  #general.root.path <- \"C:/Users/hfintern/Desktop/sa3_Scenarios\"#\"C:/Users/hfintern/Desktop/Klamath_ForestXSiskiyouCounty/Saved Output\"\n  \n  setwd(general.root.path)\n  setwd(sim)\n  \n  if (length(list.files(path = './fire')) ==0) { return(NULL) }\n  ras.list <- paste0('fire/severity-',timesteps,'.img') \n  count <- 1\n  df <- do.call( rbind, lapply(ras.list ,  function(ras) {\n    \n    r <- raster(ras)\n    vr <- values(r)\n    row <- data.frame(ID= sim, Time= count , three= sum(vr==3) , four= sum(vr==4),  five = sum(vr==5) , six= sum(vr==6), seven= sum(vr==7))\n    count <- count +1 \n    return(row)\n    \n  }))\n  \n  return(df)\n})\n\nnew <- do.call(function(l){\n  return(cbind(l,Time= timesteps))\n}, rdata)\ncomplete <- do.call(rbind, rdata)\ncomplete$Time <- rep(timesteps, length(simus.selection))\ncomplete\n#write.csv(complete ,\"D:/Evan/severityData40years.csv\")\n\nmeltSeverity <- melt(complete, id=c(\"Time\",\"three\", \"four\", \"five\", \"six\", \"seven\"))\n\n#severity -- split by early middle late \n# #max(meltSeverity$seven)\n# #min(meltSeverity$seven)\n# # graphing highest severity area \n# earlyTest <- subset(meltSeverity,  meltSeverity$Time %in% 1:30)\n# t1<- ggplot(earlyTest, aes(x=value, y=seven*7.29, color= value)) + geom_boxplot() + labs(title=\"Early\" )+ theme_bw() +theme(plot.title = element_text(margin = margin(t = 10, b = -30)))+theme(plot.title = element_text(hjust = 0.5))+ theme(axis.title.x=element_blank(), axis.text.x=element_blank(),axis.ticks.x=element_blank() )+ theme(axis.title.y=element_blank())+\n#   scale_x_discrete(labels=labs) + theme(axis.text.x = element_text(angle = 75)) +# geom_jitter(width=.3)+\n#   stat_summary(fun.y = \"mean\", geom = \"point\", shape = 8, size = 2)  + \n# \n# \n# midTest <- subset(meltSeverity,  meltSeverity$Time %in% 31:60)\n# t2<- ggplot(midTest, aes(x=value, y=seven*7.29, color= value)) + geom_boxplot()+ labs(title=\"Middle\" ) + theme_bw() +theme(plot.title = element_text(margin = margin(t = 10, b = -30)))+theme(plot.title = element_text(hjust = 0.5))+  theme(axis.title.x=element_blank(), axis.text.x=element_blank(),axis.ticks.x=element_blank())+ #theme(axis.title.y=element_blank(), axis.text.y=element_blank(),axis.ticks.y=element_blank(), axis.line.y = element_line(colour=\"grey40\", linetype = \"dashed\"))+\n#   scale_x_discrete(labels=labs) + theme(axis.text.x = element_text(angle = 75))+# geom_jitter(width=.3)+\n#   stat_summary(fun.y = \"mean\", geom = \"point\", shape = 8, size = 2) \n# \n# \n# lateTest <- subset(meltSeverity,  meltSeverity$Time %in% 61:91)\n# t3<- ggplot(lateTest, aes(x=value, y=seven*7.29, color= value)) + geom_boxplot() + labs(title=\"Late\" )+ theme_bw() +theme(plot.title = element_text(margin = margin(t = 10, b = -30))) +theme(plot.title = element_text(hjust = 0.5))+   theme(axis.title.x=element_blank(), axis.text.x=element_blank(),axis.ticks.x=element_blank())+ #theme(axis.title.y=element_blank(), axis.text.y=element_blank(),axis.ticks.y=element_blank(), axis.line.y = element_line(colour=\"grey40\", linetype = \"dashed\"))+\n#   scale_x_discrete(labels=labs) + theme(axis.text.x = element_text(angle = 75)) +# geom_jitter(width=.3)+\n#   stat_summary(fun.y = \"mean\", geom = \"point\", shape = 8, size = 2)\n# \n# figure <- ggarrange(t1,t2,t3, common.legend=T, legend=\"none\", ncol=3) \n# \n# comp <- annotate_figure(figure,  top = text_grob(paste(\"Highest Severity Fires Occurrence\"), color = \"Black\", face = \"bold\", size = 14),\n#                         bottom = text_grob(\"Scenarios\", color = \"Black\", face = \"bold\", size = 12),\n#                         left = text_grob(\"Area affected by highest severity fire (ha)\", color = \"Black\",face = \"bold\", rot = 90,size = 12))\n# comp\n# \n\n\n# scatter plot of fire severites\n\nnms <- meltSeverity\nhead(nms)\nnms[,7] <- NULL\ncolnames(nms)[7]<- \"sim\"\nnms1<- melt(nms , id=c(\"Time\",\"sim\"))\nhead(nms1)\n\n\n\nggplot(nms1, aes(x= Time , y=value*7.29 , color= variable)) + geom_point() +geom_smooth(level=.9) + facet_wrap(~sim) + theme_bw()+ \n  labs(y=\"Area affected by different severity fires (ha)\", x=\"Year\", title= \"Fire severity distributions across simulations\", color=\"Severity levels\")+\n  scale_color_manual(labels = c(\"1\", \"2\",\"3\", \"4\", \"5\"), values=  hue_pal()(5)) + guides(color=guide_legend(override.aes=list(fill=NA))) \n\n\n\n#nice severity level box plot with inset plot ----\n\nsumOfAffectedAreas <- t(data.frame(totalSites = sapply(unique(nms1$sim), function(simi){\n  return(  sum(nms1$value[nms1$sim == simi]) )\n})))\n\n\n\nlibrary(grid)\n\ng <- ggplot(nms1, aes(variable, value*7.29))\ng <- g + geom_boxplot(aes(fill=factor(sim))) + theme_bw(base_size = 20)+\n  theme(axis.text.x = element_text(angle=0, vjust=0.6)) + \n  labs(title=\"Affected area by severity level across simulations (2010-2100)\", \n       x=\"Fire severity levels\", fill = \"Scenarios\",\n       y=\"Affected area (ha)\")+\n  theme(legend.position = c(0.325, 0.89)) +\n  scale_fill_manual(labels = c(\"A2 Climate\",\"A2 Climate & LU+\", \"Recent Trends\", \"Recent Trends & LU+\"), values=  hue_pal()(4))+ \n  scale_x_discrete(labels= c(\"1\",\"2\",\"3\",\"4\",\"5 (All affected cohorts killed)\"))#, values= c(\"three\",\"four\", \"five\", \"six\", \"seven\"))\n\n\nsaamelt <- melt(sumOfAffectedAreas)\nsubplot <- ggplot(saamelt, aes(Var2, value*7.29 , fill=factor(Var2))) + theme_bw() +geom_bar(stat=\"identity\")+\n  theme(legend.position = \"none\") + labs(subtitle=\"Total affected area\", y=\"Affected Area (ha)\", x=\"Scenarios\")+ \n  theme(axis.text.x =element_blank(), axis.ticks.x = element_blank(),text = element_text(size=12))\n\nvp <- viewport(width = 0.2, height = 0.2, x = .1,y = .725, just = c(\"left\",\"bottom\"))\nfull <- function() {\n  print(g)\n  theme_set(theme_bw(base_size = 20))\n  print(subplot, vp = vp)\n  theme_set(theme_bw())\n}\nfull()\n\n\n# zooming in and ignoring the fire severity of 1 and 2 (three and four) \nnms2 <- nms1[73:180,]\n\ng <- ggplot(nms2, aes(variable, value*7.29))\ng <- g + geom_boxplot(aes(fill=factor(sim))) + theme_bw(base_size = 20)+\n  theme(axis.text.x = element_text(angle=0, vjust=0.6)) + \n  labs(title=\"Affected area by severity level across simulations (2010-2100)\", \n       x=\"Fire severity levels\", fill = \"Scenarios\",\n       y=\"Affected area (ha)\")+\n  theme(legend.position = c(0.325, 0.89)) +  coord_cartesian(ylim=c(0, 11000))+\n  scale_fill_manual(labels = c(\"A2 Climate\",\"A2 Climate & LU+\", \"Recent Trends\", \"Recent Trends & LU+\"), values=  hue_pal()(4))+ \n  scale_x_discrete(labels= c(\"3\",\"4\",\"5 (All affected cohorts killed)\"))#, values= c(\"three\",\"four\", \"five\", \"six\", \"seven\")) +\n\n\nsaamelt <- melt(sumOfAffectedAreas)\nsubplot <- ggplot(saamelt, aes(Var2, value*7.29 , fill=factor(Var2))) + theme_bw() +geom_bar(stat=\"identity\")+\n  theme(legend.position = \"none\") + labs(subtitle=\"Total affected area\", y=\"Affected Area (ha)\", x=\"Scenarios\")+ \n  theme(axis.text.x =element_blank(), axis.ticks.x = element_blank(),text = element_text(size=12))\n\nvp <- viewport(width = 0.2, height = 0.2, x = .08,y = .725, just = c(\"left\",\"bottom\"))\nfull <- function() {\n  print(g)\n  theme_set(theme_bw(base_size = 8))\n  print(subplot, vp = vp)\n  theme_set(theme_bw())\n}\nfull()\n\n\n## Total cohorts exploration ---- \n\n\ncohortData <- list()\ncohortList<- lapply (simus.selection, function (sim){\n\n  setwd(general.root.path)\n  setwd(sim)\n  \n  path<- \"output/TotalCohorts.txt\"\n  #library(gdata)\n  #df <- read.xls(path, sheet = 1, row.names=1)\n  L <- readLines(path) ##\n  for(i in 1:13) L <- sub(\"\\\\s+\", \",\", L)\n  cohortdf <- read.csv(text = L)\n  \n  #cohortdf<- read.table(path, header=T, sep = '\\t')\n  \n  \n  cohortdf <- cbind(cohortdf, sim= rep(sim, nrow(cohortdf)))\n  \n  \n  return(cohortdf)\n})\nTotalCohortData<- do.call( rbind, cohortList)\n\ncohortMelt <- melt(TotalCohortData, id=c(colnames(TotalCohortData)[1:13]))\n\nhead(cohortMelt)\n\nggplot(cohortMelt, aes(x=Time, y=X.Cohorts , color=value)) + geom_point() +geom_smooth()+ theme_bw() + \n  labs(y=\"Number of cohorts\", x=\"Time (years)\", title= \"Total cohorts over time\", color=\"Scenarios\")#+\n#scale_color_manual(labels = c(\"1\", \"2\",\"3\", \"4\", \"5\", \"6\"), values=hue_pal()(6)) + guides(color=guide_legend(override.aes=list(fill=NA)))\n\nggplot(cohortMelt, aes(x=Time, y=WoodyDebris.kgDW.m2., color=value)) + geom_smooth()+ theme_bw() + \n  labs(y=\"Amount of woody debris (kgDW/m2)\", x=\"Time (years)\", title= \"Wood Debris over time\", color=\"Scenarios\")#+\n#scale_color_manual(labels = c(\"1\", \"2\",\"3\", \"4\", \"5\", \"6\"), values=hue_pal()(6)) + guides(color=guide_legend(override.aes=list(fill=NA)))\ncohortMelt<-subset(cohortMelt, cohortMelt$Time<90)\nggplot(cohortMelt, aes(Time, WoodyDebris.kgDW.m2., fill=value, color=value)) + geom_area(stat=\"identity\",position=position_dodge(.5), alpha=.25, size=1)+ \n  coord_cartesian(ylim=c(850, max(cohortMelt$WoodyDebris.kgDW.m2.)+100))+ geom_point() + theme_bw(base_size = 20)+\n  labs(y=expression(paste(\n    \"WoodyDebris (\",\n    kg,DW, \"/\", m^2,\n    \")\", sep=\"\")),\n    x=\"Year\", title= \"Woody debris across scenarios\", color=\"Scenarios\", fill=\"Scenarios\")+\n  scale_color_manual(\"Scenarios\",labels = c(\"A2 Climate\", \"A2 Climate & LU\",\"Recent Trends\", \"Recent Trends & LU\"), values=  hue_pal()(4)) +\n  scale_fill_manual(\"Scenarios\",labels = c(\"A2 Climate\", \"A2 Climate & LU\",\"Recent Trends\", \"Recent Trends & LU\"), values=  hue_pal()(4))+ \n  scale_x_continuous(labels=c(0,timesteps)+2010, breaks = c(0,timesteps) )+\n  theme(legend.position = c(0.85, 0.1))\n\n\n\nggplot(cohortMelt, aes(Time, Litter.kgDW.m2., fill=value, color=value)) + geom_area(stat=\"identity\",position=position_dodge(.5), alpha=.25, size=1)+ \n  coord_cartesian(ylim=c(0, max(cohortMelt$Litter.kgDW.m2.)+100))+ geom_point() + theme_bw(base_size = 20)+\n  labs(y=expression(paste(\n    \"Litter (\",\n    kg,DW, \"/\", m^2,\n    \")\", sep=\"\")),\n    x=\"Year\", title= \"Litter across scenarios\", color=\"Scenarios\", fill=\"Scenarios\")+\n  scale_color_manual(\"Scenarios\",labels = c(\"A2 Climate\", \"A2 Climate & LU\",\"Recent Trends\", \"Recent Trends & LU\"), values=  hue_pal()(4)) +\n  scale_fill_manual(\"Scenarios\",labels = c(\"A2 Climate\", \"A2 Climate & LU\",\"Recent Trends\", \"Recent Trends & LU\"), values=  hue_pal()(4))+ \n  scale_x_continuous(labels=c(0,timesteps)+2010, breaks = c(0,timesteps) )+\n  theme(legend.position = c(0.85, 0.1))\n\n\n\n\nbioList <- list()\nbioList<- lapply (simus.selection, function (sim){\n  setwd(general.root.path)\n  setwd(sim)\n  \n  path<- \"output/biomass/biomass.txt\"\n  \n  biomassdf<- read.table(path, header=T, sep = '\\t')\n  \n  biomassdf <- cbind(biomassdf, sim= rep(sim, nrow(biomassdf)))\n  \n  return(biomassdf)\n})\nbiomassDF<- do.call( rbind, bioList)\nbiomassDF$X<-NULL \n\nbioMelt <- melt(biomassDF, id=c(\"Time\", \"sim\")) \n\n\nggplot(bioMelt, aes(x=Time, y=value, color=sim, linetype=variable)) +geom_smooth(size=2)+ theme_bw() +# facet_grid(~variable)+\n  labs(y=\"Biomass (g/m2)\", x=\"Time (years)\", title= \"Biomass over time\", color=\"Scenarios\")+guides(legend.position=\"bottom\")\n\n\n#unsure if the facet is more clear than the linetype \nsubBioMelt<- bioMelt\nggplot(subBioMelt, aes(x=Time, y=value, color=variable, linetype=sim)) +geom_smooth()+ theme_bw() + #facet_grid(~sim)+\n  labs(y=\"Biomass (g/m2)\", x=\"Time (years)\", title= \"Biomass over time\", color=\"Species\")+guides(legend.position=\"bottom\")\n\n\n## plotting climate data \n# Section - plot climate data -----\n\nlibrary(ggplot2)\nlibrary(reshape2)\nlibrary(gridExtra)\n\nclimate.list<- c(\"climate_A2_scenario_convertedPAR_secondredo\",\"climate_noClimateChange_scenario_convertedPAR_secondredo\")\n\nclimate.data <- list()\nclimate.data<- lapply (climate.list, function (clim){\n  \n  setwd(\"C:/Users/hfintern/Desktop/Klamath_ForestXSiskiyouCounty/climate_scenerios_klamath_all_eco_regions\")\n  setwd(clim)\n  \n  climateFiles <- list.files(pattern = \"PnET.txt\", full.names = T)\n  climateFiles\n  \n  tab <-  read.table(file = climateFiles[1], header =T,stringsAsFactors = FALSE) \n  endtab<-cbind(tab, EcoReg= rep(substr(climateFiles[1], 3,7), length(tab$Year)) )\n  \n  for (i in 2:length(climateFiles))\n  {\n    tab <-  read.table(file = climateFiles[i], header =T,stringsAsFactors = FALSE)\n    tab1<-cbind(tab, EcoReg= rep(substr(climateFiles[i], 3,7), length(tab$Year)) )\n    endtab<-rbind(endtab, tab1)\n  }\n  \n  levels(endtab$Year)\n  endtab$Year[endtab$Year==\"1200-1948\"] <- 1948  \n  \n  decimalYear <- as.double(endtab$Year )+ as.double(endtab$Month)/12.0 \n  endtab <- cbind(endtab, decimalYear)\n  endtab <- cbind(endtab, climate = rep(clim, NROW(decimalYear)))\n  \n  head(endtab)\n  \n  return(endtab)\n})\n\nmergedClimData <- do.call(rbind, climate.data)\necras <- raster(\"C:/Users/hfintern/Desktop/Klamath_ForestXSiskiyouCounty/clippedRaster/ecoregsa3.tif\")\n#meltedCD <- melt(subset(mergedClimData, grepl( paste(sort(unique(values(ecras))), collapse='|') ,mergedClimData$EcoReg) & mergedClimData$Year<2051), id.vars =c(\"Year\", \"Month\", \"decimalYear\", \"EcoReg\", \"CO2\", \"PAR\", \"O3\",\"Prec\",\"climate\"))#,\"Tmax\", \"Tmin\")) # \"Tmax\", \"Tmin\", \"PAR\", \"Prec\", \"CO2\"))\nmeltedCD <- melt(subset(mergedClimData, grepl( paste(sort(unique(values(ecras))), collapse='|') ,mergedClimData$EcoReg) ), id.vars =c(\"Year\", \"Month\", \"decimalYear\", \"EcoReg\", \"CO2\", \"PAR\", \"O3\",\"Prec\",\"climate\"))#,\"Tmax\", \"Tmin\")) # \"Tmax\", \"Tmin\", \"PAR\", \"Prec\", \"CO2\"))\n\n\n#head(meltedCD)\n\nplot1<- ggplot(data =meltedCD, aes(x=decimalYear , y=value, linetype=variable , color=climate))+\n  annotate(\"rect\", fill = \"cornsilk3\", alpha = .5, \n           xmin = -Inf, xmax = 2010 ,\n           ymin = -Inf, ymax = Inf) +\n  geom_smooth()+ facet_wrap(~EcoReg )+\n  geom_vline(xintercept=2010) + theme_bw(base_size=25)+ \n  labs(y=\"Temperature (C)\", x=\"Year\", title= \"Climate Scenarios: Average of Yearly Temperature Extremes\", color=\"Scenarios\", linetype=\"Temperatures\", fill=\"Shading\")+\n  scale_color_manual(labels = c(\"A2 Climate\", \"Recent Trends\"), values=  hue_pal()(2)) + guides(color=guide_legend(override.aes=list(fill=NA)))+\n  scale_linetype_manual(labels = c(\"Avg. max\", \"Avg. min\"), values = c(1, 4))+ guides(linetype=guide_legend(override.aes=list(fill=NA))) + \n  theme(legend.position = c(0.9, 0.1));plot1  # + geom_rect(aes(xmin=1948, xmax=2010, ymin=0, ymax=Inf, color=\"orange\"))\n#legend(labels = c(\"Historic Climate\", \"Simulated Climate\"), values=  c( \"burlywood4\", \"white\" ))\n\n\n\n#meltedCD <- melt(subset(mergedClimData, grepl( paste(sort(unique(values(ecras))), collapse='|') ,mergedClimData$EcoReg) & mergedClimData$Year<2051 & mergedClimData$Year>2009), id.vars =c(\"Year\", \"Month\", \"decimalYear\", \"EcoReg\", \"CO2\", \"PAR\", \"O3\",\"Prec\",\"climate\"))#,\"Tmax\", \"Tmin\")) # \"Tmax\", \"Tmin\", \"PAR\", \"Prec\", \"CO2\"))\nmeltedCD <- melt(subset(mergedClimData, grepl( paste(sort(unique(values(ecras))), collapse='|') ,mergedClimData$EcoReg) & mergedClimData$Year>2009), id.vars =c(\"Year\", \"Month\", \"decimalYear\", \"EcoReg\", \"CO2\", \"PAR\", \"O3\",\"Prec\",\"climate\"))#,\"Tmax\", \"Tmin\")) # \"Tmax\", \"Tmin\", \"PAR\", \"Prec\", \"CO2\"))\n\nplotprec<- ggplot(data =meltedCD, aes(x=Month , y=Prec/10 , color=climate))+\n  geom_smooth()+# facet_wrap(~EcoReg )+#geom_vline(xintercept=2010) + \n  theme_bw(base_size=25)+ \n  labs(y=\"Precipitation (cm)\", x=\"Month\", title= \"Climate Scenarios: Average Monthly Precipitation (2010-2100)\", color=\"Scenarios\")+\n  scale_color_manual(labels = c(\"A2 Climate\", \"Recent Trends\"), values=  hue_pal()(2)) + guides(color=guide_legend(override.aes=list(fill=NA)))+\n  scale_x_continuous(labels=c(\"Jan\", \"Mar\", \"May\", \"Jul\", \"Sept\", \"Nov\"), breaks=c(1,3,5,7,9,11))+\n  theme(legend.position = c(0.9, 0.1));plotprec \n\n\n#meltedCD <- melt(subset(mergedClimData, grepl( paste(sort(unique(values(ecras))), collapse='|') ,mergedClimData$EcoReg) & mergedClimData$Year<2051 & mergedClimData$Year>1948), id.vars =c(\"Year\", \"Month\", \"decimalYear\", \"EcoReg\", \"CO2\", \"PAR\", \"O3\",\"Prec\",\"climate\"))#,\"Tmax\", \"Tmin\")) # \"Tmax\", \"Tmin\", \"PAR\", \"Prec\", \"CO2\"))\nmeltedCD <- melt(subset(mergedClimData, grepl( paste(sort(unique(values(ecras))), collapse='|') ,mergedClimData$EcoReg)  & mergedClimData$Year>1948), id.vars =c(\"Year\", \"Month\", \"decimalYear\", \"EcoReg\", \"CO2\", \"PAR\", \"O3\",\"Prec\",\"climate\"))#,\"Tmax\", \"Tmin\")) # \"Tmax\", \"Tmin\", \"PAR\", \"Prec\", \"CO2\"))\nplotprec<- ggplot(data =meltedCD, aes(x=decimalYear , y=CO2 , color=climate))+\n  annotate(\"rect\", fill = \"cornsilk3\", alpha = .5, \n           xmin = -Inf, xmax = 2010 ,\n           ymin = -Inf, ymax = Inf) +\n  geom_smooth()+# facet_wrap(~EcoReg )+\n  geom_vline(xintercept=2010)+ theme_bw(base_size=25)+\n  labs(y=\"CO2 (ppm)\", x=\"Year\", title= \"Climate Scenarios: Mean Atmospheric CO2 Concentration\", color=\"Scenarios\")+\n  scale_color_manual(labels = c(\"A2 Climate\", \"Recent Trends\"), values=  hue_pal()(2)) + guides(color=guide_legend(override.aes=list(fill=NA)))+\n  theme(legend.position = c(0.9, 0.35));plotprec \n\n\n#early mid late climate graphs----\n\n#PRECIPITATION\nmeltedCD$Prec <- meltedCD$Prec/10 # mm to cm\n\nearlyTest <- subset(meltedCD, meltedCD$Year  %in% 2010:2040)\nt1<- ggplot(earlyTest, aes(x=Month, y=Prec, color=climate)) + geom_smooth() + labs(title=\"Early\\n(2010-2040)\" )+theme_bw(base_size=20) +theme(plot.title = element_text(margin = margin(t = 10, b = -70)))+theme(plot.title = element_text(hjust = 0.5))+\n           coord_cartesian(ylim=c(0, 43))+ \n           scale_color_manual(\"Scenarios\",labels = c(\"A2 Climate\", \"Recent Trends\"), values=  hue_pal()(2)) + guides(color=guide_legend(override.aes=list(fill=NA)))+\n           scale_x_continuous(labels=c(\"Jan\", \"Mar\", \"May\", \"Jul\", \"Sept\", \"Nov\"), breaks=c(1,3,5,7,9,11))+\n           theme(axis.title.x = element_blank(), axis.title.y = element_blank())\n\nmidTest <- subset(meltedCD,  meltedCD$Year  %in% 2041:2070)\nt2<- ggplot(midTest, aes(x=Month, y=Prec,color=climate))  + geom_smooth()+ labs(title=\"Middle\\n(2041-2070)\" )+theme_bw(base_size=20) +theme(plot.title = element_text(margin = margin(t = 10, b = -70)))+theme(plot.title = element_text(hjust = 0.5))+\n           coord_cartesian(ylim=c(0, 43))+  \n           scale_color_manual(\"Scenarios\",labels = c(\"A2 Climate\", \"Recent Trends\"), values=  hue_pal()(2)) + guides(color=guide_legend(override.aes=list(fill=NA)))+\n           scale_x_continuous(labels=c(\"Jan\", \"Mar\", \"May\", \"Jul\", \"Sept\", \"Nov\"), breaks=c(1,3,5,7,9,11))+\n           theme(axis.title.x = element_blank(), axis.title.y = element_blank())\n  \nlateTest <- subset(meltedCD, meltedCD$Year  %in% 2071:2101)\nt3<- ggplot(lateTest, aes(x=Month, y=Prec,color=climate))  + geom_smooth() + labs(title=\"Late\\n(2071-2100)\" )+theme_bw(base_size=20)+theme(plot.title = element_text(margin = margin(t = 10, b = -70))) +theme(plot.title = element_text(hjust = 0.5))+\n            coord_cartesian(ylim=c(0, 43))+\n            scale_color_manual(\"Scenarios\",labels = c(\"A2 Climate\", \"Recent Trends\"), values=  hue_pal()(2)) + guides(color=guide_legend(override.aes=list(fill=NA)))+\n            scale_x_continuous(labels=c(\"Jan\", \"Mar\", \"May\", \"Jul\", \"Sept\", \"Nov\"), breaks=c(1,3,5,7,9,11))+\n            theme(axis.title.x = element_blank(), axis.title.y = element_blank())\n  \nfigure <- ggarrange(t1,t2,t3, common.legend=T, legend=\"top\", ncol=3) \n\ncomp <- annotate_figure(figure,  top = text_grob(paste(\"Precipitation (2010-2100)\"), color = \"Black\", face = \"bold\", size = 25),\n                        bottom = text_grob(\"Months\", color = \"Black\", face = \"bold\", size = 25),\n                        left = text_grob(\"Precipitation (cm)\", color = \"Black\",face = \"bold\", rot = 90,size = 25))\ncomp\n\n\n\n#TEMPERATURE \nearlyTest <- subset(meltedCD, meltedCD$Year  %in% 2010:2040)\nt1<- ggplot(earlyTest, aes(x=Month, y=value, color=climate, linetype=variable))  + geom_smooth() + labs(title=\"Early\\n(2010-2040)\"  )+theme_bw(base_size=20)+theme(plot.title = element_text(margin = margin(t = 10, b = -70))) +theme(plot.title = element_text(hjust = 0.5))+\n  coord_cartesian(ylim=c(-3, 32))+\n  scale_color_manual(\"Scenarios\",labels = c(\"A2 Climate\", \"Recent Trends\"), values=  hue_pal()(2)) + guides(color=guide_legend(override.aes=list(fill=NA)))+\n  scale_linetype_manual(\"Temperatures\",labels = c(\"Avg. max\", \"Avg. min\"), values = c(1, 4))+ guides(linetype=guide_legend(override.aes=list(fill=NA))) + \n  scale_x_continuous(labels=c(\"Jan\", \"Mar\", \"May\", \"Jul\", \"Sept\", \"Nov\"), breaks=c(1,3,5,7,9,11))+\n  theme(axis.title.x = element_blank(), axis.title.y = element_blank())\n\nmidTest <- subset(meltedCD,  meltedCD$Year  %in% 2041:2070)\nt2<- ggplot(midTest, aes(x=Month, y=value,color=climate, linetype=variable))  + geom_smooth() + labs(title=\"Middle\\n(2041-2070)\" )+theme_bw(base_size=20)+theme(plot.title = element_text(margin = margin(t = 10, b = -70))) +theme(plot.title = element_text(hjust = 0.5))+\n  coord_cartesian(ylim=c(-3, 32))+\n  scale_color_manual(\"Scenarios\",labels = c(\"A2 Climate\", \"Recent Trends\"), values=  hue_pal()(2)) + guides(color=guide_legend(override.aes=list(fill=NA)))+\n  scale_linetype_manual(\"Temperatures\",labels = c(\"Avg. max\", \"Avg. min\"), values = c(1, 4))+ guides(linetype=guide_legend(override.aes=list(fill=NA))) + \n  scale_x_continuous(labels=c(\"Jan\", \"Mar\", \"May\", \"Jul\", \"Sept\", \"Nov\"), breaks=c(1,3,5,7,9,11))+\n  theme(axis.title.x = element_blank(), axis.title.y = element_blank())\n\nlateTest <- subset(meltedCD, meltedCD$Year  %in% 2071:2101)\nt3<- ggplot(lateTest, aes(x=Month, y=value,color=climate, linetype=variable))  + geom_smooth() + labs(title=\"Late\\n(2071-2100)\" )+theme_bw(base_size=20)+theme(plot.title = element_text(margin = margin(t = 10, b = -70))) +theme(plot.title = element_text(hjust = 0.5))+\n  coord_cartesian(ylim=c(-3, 32))+\n  scale_color_manual(\"Scenarios\",labels = c(\"A2 Climate\", \"Recent Trends\"), values=  hue_pal()(2)) + guides(color=guide_legend(override.aes=list(fill=NA)))+\n  scale_linetype_manual(\"Temperatures\",labels = c(\"Avg. max\", \"Avg. min\"), values = c(1, 4))+ guides(linetype=guide_legend(override.aes=list(fill=NA))) + \n  scale_x_continuous(labels=c(\"Jan\", \"Mar\", \"May\", \"Jul\", \"Sept\", \"Nov\"), breaks=c(1,3,5,7,9,11))+\n  theme(axis.title.x = element_blank(), axis.title.y = element_blank())\n\nfigure <- ggarrange(t1,t2,t3, common.legend=T, legend=\"top\", ncol=3) \n\n\ncomp <- annotate_figure(figure,  top = text_grob(\"Temperature (2010-2100)\", color = \"Black\", face = \"bold\", size = 25),\n                        bottom = text_grob(\"Month\", color = \"Black\", face = \"bold\", size = 25),\n                        left = text_grob(\"Temperature (°C)\", color = \"Black\",face = \"bold\", rot = 90,size = 25))\ncomp\n\n",
    "created" : 1532108176717.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1812168097",
    "id" : "7681382A",
    "lastKnownWriteTime" : 1532108106,
    "last_content_update" : 1532108106,
    "path" : "C:/Users/hfintern/Desktop/LANDIS_Klamath_REU2018/graphing10YTS.R",
    "project_path" : "graphing10YTS.R",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}